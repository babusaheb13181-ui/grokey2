<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BookMarket - Buy & Sell Books</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .nav-btn.active {
            background-color: #3b82f6;
            color: white;
        }
        .book-card {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .book-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .sell-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            transition: all 0.3s ease;
        }
        .sell-btn:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: scale(1.05);
        }
        @keyframes popupSlideIn {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }
        @keyframes popupSlideOut {
            from {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            to {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-full">
    <div class="max-w-md mx-auto bg-white min-h-full shadow-lg">
        <!-- Header -->
        <div class="bg-blue-600 text-white p-4">
            <div class="flex justify-between items-center">
                <div class="text-center flex-1">
                    <h1 class="text-xl font-bold">üìö GROKEY: THE KEY OF SUCCESS</h1>
                    <p class="text-sm opacity-90">Buy & Sell Books Online</p>
                </div>
                <div class="flex space-x-3">
                    <button onclick="showChat()" class="relative p-2 bg-blue-700 rounded-full hover:bg-blue-800 transition-colors">
                        <span class="text-lg">üí¨</span>
                        <span id="chatBadge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">3</span>
                    </button>
                    <button onclick="showCart()" class="relative p-2 bg-blue-700 rounded-full hover:bg-blue-800 transition-colors">
                        <span class="text-lg">üõí</span>
                        <span id="cartBadge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">4</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="pb-20">
            <!-- Home Tab -->
            <div id="home" class="tab-content active">
                <div class="p-4">
                    <!-- Search Bar -->
                    <div class="mb-4">
                        <div class="relative">
                            <input type="text" placeholder="Search books, authors, subjects..." class="w-full p-3 border border-gray-300 rounded-lg pl-10 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <span class="absolute left-3 top-3 text-gray-400">üîç</span>
                        </div>
                    </div>

                    <!-- Filter Options -->
                    <div class="flex space-x-2 mb-4">
                        <select class="flex-1 p-2 border border-gray-300 rounded-lg text-sm">
                            <option>All Categories</option>
                            <option>Fiction</option>
                            <option>Academic</option>
                            <option>Business</option>
                            <option>Science</option>
                        </select>
                        <select class="flex-1 p-2 border border-gray-300 rounded-lg text-sm">
                            <option>All Conditions</option>
                            <option>New</option>
                            <option>Like New</option>
                            <option>Good</option>
                            <option>Fair</option>
                        </select>
                    </div>

                    <!-- Books Marketplace -->
                    <div class="space-y-3">
                        <div class="book-card bg-white border border-gray-200 rounded-lg p-4 cursor-pointer" onclick="showBookDetails('gatsby')">
                            <div class="flex">
                                <div class="w-16 h-20 bg-blue-200 rounded flex items-center justify-center mr-4">
                                    <span class="text-2xl">üìö</span>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">The Great Gatsby</h4>
                                    <p class="text-sm text-gray-600">F. Scott Fitzgerald ‚Ä¢ Fiction</p>
                                    <p class="text-xs text-gray-500 mt-1">üìç New York, NY ‚Ä¢ Posted 2 days ago</p>
                                    <div class="flex justify-between items-center mt-2">
                                        <span class="text-lg font-bold text-green-600">‚Çπ1,080</span>
                                        <div class="flex space-x-2">
                                            <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">Good</span>
                                            <button onclick="event.stopPropagation(); chatWithSeller('gatsby')" class="text-blue-600 text-sm hover:underline">üí¨ Chat</button>
                                        </div>
                                    </div>
                                    <div class="flex items-center mt-2">
                                        <div class="w-6 h-6 bg-gray-300 rounded-full mr-2"></div>
                                        <span class="text-xs text-gray-600">Sarah M. ‚Ä¢ ‚≠ê 4.8 (23 reviews)</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="book-card bg-white border border-gray-200 rounded-lg p-4 cursor-pointer" onclick="showBookDetails('python')">
                            <div class="flex">
                                <div class="w-16 h-20 bg-green-200 rounded flex items-center justify-center mr-4">
                                    <span class="text-2xl">üìñ</span>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">Python Programming</h4>
                                    <p class="text-sm text-gray-600">John Smith ‚Ä¢ Computer Science</p>
                                    <p class="text-xs text-gray-500 mt-1">üìç Boston, MA ‚Ä¢ Posted 1 day ago</p>
                                    <div class="flex justify-between items-center mt-2">
                                        <span class="text-lg font-bold text-green-600">‚Çπ3,740</span>
                                        <div class="flex space-x-2">
                                            <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">Like New</span>
                                            <button onclick="event.stopPropagation(); chatWithSeller('python')" class="text-blue-600 text-sm hover:underline">üí¨ Chat</button>
                                        </div>
                                    </div>
                                    <div class="flex items-center mt-2">
                                        <div class="w-6 h-6 bg-gray-300 rounded-full mr-2"></div>
                                        <span class="text-xs text-gray-600">Mike R. ‚Ä¢ ‚≠ê 4.9 (45 reviews)</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="book-card bg-white border border-gray-200 rounded-lg p-4 cursor-pointer" onclick="showBookDetails('calculus')">
                            <div class="flex">
                                <div class="w-16 h-20 bg-purple-200 rounded flex items-center justify-center mr-4">
                                    <span class="text-2xl">üìò</span>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">Calculus: Early Transcendentals</h4>
                                    <p class="text-sm text-gray-600">James Stewart ‚Ä¢ Mathematics</p>
                                    <p class="text-xs text-gray-500 mt-1">üìç Chicago, IL ‚Ä¢ Posted 3 hours ago</p>
                                    <div class="flex justify-between items-center mt-2">
                                        <span class="text-lg font-bold text-green-600">‚Çπ7,065</span>
                                        <div class="flex space-x-2">
                                            <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded">Good</span>
                                            <button onclick="event.stopPropagation(); chatWithSeller('calculus')" class="text-blue-600 text-sm hover:underline">üí¨ Chat</button>
                                        </div>
                                    </div>
                                    <div class="flex items-center mt-2">
                                        <div class="w-6 h-6 bg-gray-300 rounded-full mr-2"></div>
                                        <span class="text-xs text-gray-600">Emma L. ‚Ä¢ ‚≠ê 5.0 (12 reviews)</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="book-card bg-white border border-gray-200 rounded-lg p-4 cursor-pointer" onclick="showBookDetails('marketing')">
                            <div class="flex">
                                <div class="w-16 h-20 bg-red-200 rounded flex items-center justify-center mr-4">
                                    <span class="text-2xl">üìó</span>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">Marketing Management</h4>
                                    <p class="text-sm text-gray-600">Philip Kotler ‚Ä¢ Business</p>
                                    <p class="text-xs text-gray-500 mt-1">üìç Los Angeles, CA ‚Ä¢ Posted 5 days ago</p>
                                    <div class="flex justify-between items-center mt-2">
                                        <span class="text-lg font-bold text-green-600">‚Çπ5,403</span>
                                        <div class="flex space-x-2">
                                            <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">Fair</span>
                                            <button onclick="event.stopPropagation(); chatWithSeller('marketing')" class="text-blue-600 text-sm hover:underline">üí¨ Chat</button>
                                        </div>
                                    </div>
                                    <div class="flex items-center mt-2">
                                        <div class="w-6 h-6 bg-gray-300 rounded-full mr-2"></div>
                                        <span class="text-xs text-gray-600">Alex K. ‚Ä¢ ‚≠ê 4.7 (31 reviews)</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="book-card bg-white border border-gray-200 rounded-lg p-4 cursor-pointer" onclick="showBookDetails('physics')">
                            <div class="flex">
                                <div class="w-16 h-20 bg-yellow-200 rounded flex items-center justify-center mr-4">
                                    <span class="text-2xl">üìô</span>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">University Physics</h4>
                                    <p class="text-sm text-gray-600">Young & Freedman ‚Ä¢ Physics</p>
                                    <p class="text-xs text-gray-500 mt-1">üìç Seattle, WA ‚Ä¢ Posted 1 week ago</p>
                                    <div class="flex justify-between items-center mt-2">
                                        <span class="text-lg font-bold text-green-600">‚Çπ9,974</span>
                                        <div class="flex space-x-2">
                                            <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">New</span>
                                            <button onclick="event.stopPropagation(); chatWithSeller('physics')" class="text-blue-600 text-sm hover:underline">üí¨ Chat</button>
                                        </div>
                                    </div>
                                    <div class="flex items-center mt-2">
                                        <div class="w-6 h-6 bg-gray-300 rounded-full mr-2"></div>
                                        <span class="text-xs text-gray-600">David P. ‚Ä¢ ‚≠ê 4.6 (18 reviews)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- My Books Tab -->
            <div id="mybooks" class="tab-content">
                <div class="p-4">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-gray-800">My Listed Books</h2>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition-colors">+ Add Book</button>
                    </div>

                    <div class="space-y-4">
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex">
                                <div class="w-16 h-20 bg-purple-200 rounded flex items-center justify-center mr-4">
                                    <span class="text-2xl">üìò</span>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">Data Structures</h4>
                                    <p class="text-sm text-gray-600">Computer Science</p>
                                    <div class="flex justify-between items-center mt-2">
                                        <span class="text-lg font-bold text-green-600">‚Çπ2,909</span>
                                        <div class="flex space-x-2">
                                            <button class="text-blue-600 text-sm hover:underline">Edit</button>
                                            <button class="text-red-600 text-sm hover:underline">Remove</button>
                                        </div>
                                    </div>
                                    <div class="mt-2">
                                        <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded">Pending</span>
                                        <span class="text-xs text-gray-500 ml-2">2 views</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex">
                                <div class="w-16 h-20 bg-red-200 rounded flex items-center justify-center mr-4">
                                    <span class="text-2xl">üìó</span>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">Marketing Basics</h4>
                                    <p class="text-sm text-gray-600">Business Studies</p>
                                    <div class="flex justify-between items-center mt-2">
                                        <span class="text-lg font-bold text-green-600">‚Çπ2,327</span>
                                        <div class="flex space-x-2">
                                            <button class="text-blue-600 text-sm hover:underline">Edit</button>
                                            <button class="text-red-600 text-sm hover:underline">Remove</button>
                                        </div>
                                    </div>
                                    <div class="mt-2">
                                        <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">Active</span>
                                        <span class="text-xs text-gray-500 ml-2">15 views</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 text-center text-gray-500">
                        <p class="mb-4">Want to sell more books?</p>
                        <button onclick="showTab('sell')" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors">
                            üìö List a Book for Sale
                        </button>
                    </div>
                </div>
            </div>

            <!-- Sell Book Tab -->
            <div id="sell" class="tab-content">
                <div class="p-4">
                    <h2 class="text-xl font-bold text-gray-800 mb-6">üìö Sell Your Book</h2>
                    
                    <form onsubmit="handleSellBook(event)" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Book Title *</label>
                            <input type="text" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Enter book title">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Author *</label>
                            <input type="text" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Enter author name">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Category *</label>
                            <select required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option value="">Select category</option>
                                <option value="fiction">Fiction</option>
                                <option value="academic">Academic</option>
                                <option value="business">Business</option>
                                <option value="science">Science</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Condition *</label>
                            <select required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option value="">Select condition</option>
                                <option value="new">New</option>
                                <option value="like-new">Like New</option>
                                <option value="good">Good</option>
                                <option value="fair">Fair</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Price (‚Çπ) *</label>
                            <input type="number" required min="0" step="1" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="0">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                            <textarea rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Describe the book condition, any notes..."></textarea>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Upload Photos</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                                <div class="text-4xl mb-2">üì∑</div>
                                <p class="text-gray-600">Tap to add photos</p>
                                <p class="text-xs text-gray-500 mt-1">Up to 5 photos</p>
                            </div>
                        </div>

                        <button type="submit" class="sell-btn w-full text-white py-4 rounded-lg font-semibold text-lg">
                            üöÄ List Book for Sale
                        </button>
                    </form>
                </div>
            </div>

            <!-- New Books B2C Tab -->
            <div id="newbooks" class="tab-content">
                <div class="p-4">
                    <h2 class="text-xl font-bold text-gray-800 mb-6">üìñ New Books Store</h2>
                    
                    <!-- Filter Options -->
                    <div class="mb-6">
                        <div class="flex space-x-2 mb-4">
                            <select class="flex-1 p-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option>All Categories</option>
                                <option>Fiction</option>
                                <option>Academic</option>
                                <option>Business</option>
                                <option>Science</option>
                            </select>
                            <select class="flex-1 p-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option>Sort by</option>
                                <option>Price: Low to High</option>
                                <option>Price: High to Low</option>
                                <option>Newest First</option>
                                <option>Best Sellers</option>
                            </select>
                        </div>
                    </div>

                    <!-- New Books Grid -->
                    <div class="space-y-4">
                        <div class="book-card bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex">
                                <div class="w-16 h-20 bg-blue-300 rounded flex items-center justify-center mr-4">
                                    <span class="text-2xl">üìö</span>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">Clean Code</h4>
                                    <p class="text-sm text-gray-600">Robert C. Martin</p>
                                    <div class="flex items-center mt-1">
                                        <span class="text-yellow-400">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                        <span class="text-xs text-gray-500 ml-2">(4.8)</span>
                                    </div>
                                    <div class="flex justify-between items-center mt-2">
                                        <div>
                                            <span class="text-lg font-bold text-green-600">‚Çπ3,573</span>
                                            <span class="text-sm text-gray-500 line-through ml-2">‚Çπ4,157</span>
                                        </div>
                                        <button onclick="addToCartWithQuantity(this)" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition-colors">Add to Cart</button>
                                    </div>
                                    <div class="mt-2">
                                        <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">New Release</span>
                                        <span class="text-xs bg-red-100 text-red-800 px-2 py-1 rounded ml-2">15% Off</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="book-card bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex">
                                <div class="w-16 h-20 bg-purple-300 rounded flex items-center justify-center mr-4">
                                    <span class="text-2xl">üìñ</span>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">Atomic Habits</h4>
                                    <p class="text-sm text-gray-600">James Clear</p>
                                    <div class="flex items-center mt-1">
                                        <span class="text-yellow-400">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                        <span class="text-xs text-gray-500 ml-2">(4.9)</span>
                                    </div>
                                    <div class="flex justify-between items-center mt-2">
                                        <span class="text-lg font-bold text-green-600">‚Çπ1,579</span>
                                        <button onclick="addToCartWithQuantity(this)" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition-colors">Add to Cart</button>
                                    </div>
                                    <div class="mt-2">
                                        <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded">Best Seller</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="book-card bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex">
                                <div class="w-16 h-20 bg-green-300 rounded flex items-center justify-center mr-4">
                                    <span class="text-2xl">üìò</span>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">The Psychology of Money</h4>
                                    <p class="text-sm text-gray-600">Morgan Housel</p>
                                    <div class="flex items-center mt-1">
                                        <span class="text-yellow-400">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                        <span class="text-xs text-gray-500 ml-2">(4.7)</span>
                                    </div>
                                    <div class="flex justify-between items-center mt-2">
                                        <span class="text-lg font-bold text-green-600">‚Çπ1,413</span>
                                        <button onclick="addToCartWithQuantity(this)" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition-colors">Add to Cart</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Tab -->
            <div id="chat" class="tab-content">
                <!-- Chat List View -->
                <div id="chatList" class="p-4">
                    <h2 class="text-xl font-bold text-gray-800 mb-6">üí¨ Messages</h2>
                    
                    <div class="space-y-3">
                        <div class="bg-white border border-gray-200 rounded-lg p-4 cursor-pointer hover:bg-gray-50" onclick="openChat('sarah')">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-blue-200 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-lg">üë§</span>
                                </div>
                                <div class="flex-1">
                                    <div class="flex justify-between items-start">
                                        <h4 class="font-semibold text-gray-800">Sarah M.</h4>
                                        <span class="text-xs text-gray-500">2 min ago</span>
                                    </div>
                                    <p class="text-sm text-gray-600">The Great Gatsby - $12.99</p>
                                    <p class="text-sm text-gray-800 mt-1">Is the book still available? Can we meet tomorrow?</p>
                                </div>
                                <div class="w-3 h-3 bg-red-500 rounded-full ml-2"></div>
                            </div>
                        </div>

                        <div class="bg-white border border-gray-200 rounded-lg p-4 cursor-pointer hover:bg-gray-50" onclick="openChat('mike')">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-green-200 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-lg">üë§</span>
                                </div>
                                <div class="flex-1">
                                    <div class="flex justify-between items-start">
                                        <h4 class="font-semibold text-gray-800">Mike R.</h4>
                                        <span class="text-xs text-gray-500">1 hour ago</span>
                                    </div>
                                    <p class="text-sm text-gray-600">Python Programming - $45.00</p>
                                    <p class="text-sm text-gray-800 mt-1">Thanks for your interest! Yes, it's available.</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white border border-gray-200 rounded-lg p-4 cursor-pointer hover:bg-gray-50" onclick="openChat('emma')">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-purple-200 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-lg">üë§</span>
                                </div>
                                <div class="flex-1">
                                    <div class="flex justify-between items-start">
                                        <h4 class="font-semibold text-gray-800">Emma L.</h4>
                                        <span class="text-xs text-gray-500">3 hours ago</span>
                                    </div>
                                    <p class="text-sm text-gray-600">Calculus: Early Transcendentals - $85.00</p>
                                    <p class="text-sm text-gray-800 mt-1">Hi! Can you send more photos of the book?</p>
                                </div>
                                <div class="w-3 h-3 bg-red-500 rounded-full ml-2"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Individual Chat View -->
                <div id="chatWindow" class="hidden">
                    <!-- Chat Header -->
                    <div class="bg-blue-600 text-white p-4 flex items-center">
                        <button onclick="closeChatWindow()" class="mr-3 text-xl">‚Üê</button>
                        <div class="w-10 h-10 bg-blue-400 rounded-full flex items-center justify-center mr-3">
                            <span id="chatUserAvatar">üë§</span>
                        </div>
                        <div class="flex-1">
                            <h3 id="chatUserName" class="font-semibold">Sarah M.</h3>
                            <p id="chatUserStatus" class="text-xs opacity-90">Online</p>
                        </div>
                        <button class="text-xl">üìû</button>
                    </div>

                    <!-- Chat Messages -->
                    <div id="chatMessages" class="flex-1 p-4 space-y-3 bg-gray-50" style="height: calc(100% - 140px); overflow-y: auto;">
                        <!-- Messages will be populated by JavaScript -->
                    </div>

                    <!-- Message Input -->
                    <div class="bg-white border-t p-4">
                        <div class="flex items-center space-x-2">
                            <button class="text-gray-500 text-xl">üìé</button>
                            <input 
                                type="text" 
                                id="messageInput" 
                                placeholder="Type a message..." 
                                class="flex-1 p-3 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                                onkeypress="handleMessageKeyPress(event)"
                            >
                            <button onclick="sendMessage()" class="bg-blue-600 text-white p-3 rounded-full hover:bg-blue-700 transition-colors">
                                <span class="text-sm">‚û§</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cart Tab -->
            <div id="cart" class="tab-content">
                <div class="p-4">
                    <h2 class="text-xl font-bold text-gray-800 mb-6">üõí Shopping Cart</h2>
                    
                    <div id="cartItems" class="space-y-4">
                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex">
                                <div class="w-16 h-20 bg-blue-300 rounded flex items-center justify-center mr-4">
                                    <span class="text-2xl">üìö</span>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">Clean Code</h4>
                                    <p class="text-sm text-gray-600">Robert C. Martin</p>
                                    <div class="flex justify-between items-center mt-2">
                                        <span class="text-lg font-bold text-green-600">‚Çπ3,573</span>
                                        <div class="flex items-center space-x-2">
                                            <button onclick="updateCartQuantity(this, -1)" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm hover:bg-gray-300">-</button>
                                            <span class="text-sm font-medium cart-quantity">1</span>
                                            <button onclick="updateCartQuantity(this, 1)" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm hover:bg-gray-300">+</button>
                                            <button onclick="removeFromCart(this)" class="text-red-600 text-sm ml-4 hover:text-red-800">üóëÔ∏è</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex">
                                <div class="w-16 h-20 bg-purple-300 rounded flex items-center justify-center mr-4">
                                    <span class="text-2xl">üìñ</span>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">Atomic Habits</h4>
                                    <p class="text-sm text-gray-600">James Clear</p>
                                    <div class="flex justify-between items-center mt-2">
                                        <span class="text-lg font-bold text-green-600">‚Çπ1,579</span>
                                        <div class="flex items-center space-x-2">
                                            <button onclick="updateCartQuantity(this, -1)" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm hover:bg-gray-300">-</button>
                                            <span class="text-sm font-medium cart-quantity">1</span>
                                            <button onclick="updateCartQuantity(this, 1)" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm hover:bg-gray-300">+</button>
                                            <button onclick="removeFromCart(this)" class="text-red-600 text-sm ml-4 hover:text-red-800">üóëÔ∏è</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white border border-gray-200 rounded-lg p-4">
                            <div class="flex">
                                <div class="w-16 h-20 bg-green-300 rounded flex items-center justify-center mr-4">
                                    <span class="text-2xl">üìò</span>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">The Psychology of Money</h4>
                                    <p class="text-sm text-gray-600">Morgan Housel</p>
                                    <div class="flex justify-between items-center mt-2">
                                        <span class="text-lg font-bold text-green-600">‚Çπ1,413</span>
                                        <div class="flex items-center space-x-2">
                                            <button onclick="updateCartQuantity(this, -1)" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm hover:bg-gray-300">-</button>
                                            <span class="text-sm font-medium cart-quantity">2</span>
                                            <button onclick="updateCartQuantity(this, 1)" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm hover:bg-gray-300">+</button>
                                            <button onclick="removeFromCart(this)" class="text-red-600 text-sm ml-4 hover:text-red-800">üóëÔ∏è</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Cart Summary -->
                    <div class="mt-6 bg-gray-50 rounded-lg p-4">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-gray-600">Subtotal (<span id="totalItems">4</span> items):</span>
                            <span class="font-semibold" id="subtotal">‚Çπ7,978</span>
                        </div>
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-gray-600">Shipping:</span>
                            <span class="font-semibold">‚Çπ499</span>
                        </div>
                        <div class="border-t pt-2 mt-2">
                            <div class="flex justify-between items-center">
                                <span class="text-lg font-bold">Total:</span>
                                <span class="text-lg font-bold text-green-600" id="grandTotal">‚Çπ8,477</span>
                            </div>
                        </div>
                    </div>

                    <!-- Payment Gateway Options -->
                    <div class="mt-6 bg-gray-50 rounded-lg p-4">
                        <h3 class="font-semibold text-gray-800 mb-3">üí≥ Payment Method</h3>
                        <div class="bg-white border-2 border-purple-200 rounded-lg p-4 mb-4">
                            <div class="flex items-center justify-center mb-3">
                                <div class="w-12 h-12 bg-purple-600 rounded-lg flex items-center justify-center mr-3">
                                    <span class="text-white font-bold text-lg">Pe</span>
                                </div>
                                <div>
                                    <h4 class="font-bold text-purple-600 text-lg">PhonePe</h4>
                                    <p class="text-sm text-gray-600">UPI Payment</p>
                                </div>
                            </div>
                            <div class="bg-gray-50 rounded-lg p-3 mb-3">
                                <p class="text-sm text-gray-600 mb-1">UPI ID:</p>
                                <p class="font-mono text-sm font-semibold text-purple-600">rajput450@ybl</p>
                            </div>
                            <div class="text-xs text-gray-500 mb-3">
                                ‚úÖ Secure UPI Payment<br>
                                ‚úÖ Instant Transaction<br>
                                ‚úÖ No Additional Charges
                            </div>
                        </div>
                        <button onclick="proceedWithPhonePe()" class="w-full bg-purple-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-purple-700 transition-colors flex items-center justify-center">
                            <span class="mr-2">üì±</span>
                            Pay ‚Çπ<span id="totalInRupees">8,477</span> via PhonePe
                        </button>
                        <p class="text-xs text-center text-gray-500 mt-2">
                            You will be redirected to PhonePe app for secure payment
                        </p>
                    </div>

                    <div class="text-center mt-4">
                        <button onclick="showTab('home')" class="text-blue-600 hover:underline">‚Üê Continue Shopping</button>
                    </div>
                </div>
            </div>

            <!-- My Account Tab -->
            <div id="account" class="tab-content">
                <div class="p-4">
                    <div class="text-center mb-6">
                        <div class="w-20 h-20 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-3xl text-white">üë§</span>
                        </div>
                        <h2 class="text-xl font-bold text-gray-800">My Account</h2>
                    </div>

                    <form onsubmit="handleUpdateProfile(event)" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                            <input type="text" value="John Doe" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                            <input type="email" value="john.doe@email.com" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                            <input type="tel" value="+1 (555) 123-4567" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Address</label>
                            <textarea rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">123 Main Street
New York, NY 10001
United States</textarea>
                        </div>

                        <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                            üíæ Update Profile
                        </button>
                    </form>

                    <!-- Account Options -->
                    <div class="mt-8 space-y-3">
                        <button class="w-full bg-gray-100 text-gray-800 py-3 rounded-lg font-medium hover:bg-gray-200 transition-colors flex items-center justify-center">
                            <span class="mr-2">üîí</span>
                            Change Password
                        </button>
                        
                        <button class="w-full bg-gray-100 text-gray-800 py-3 rounded-lg font-medium hover:bg-gray-200 transition-colors flex items-center justify-center">
                            <span class="mr-2">üìä</span>
                            Sales History
                        </button>
                        
                        <button class="w-full bg-gray-100 text-gray-800 py-3 rounded-lg font-medium hover:bg-gray-200 transition-colors flex items-center justify-center">
                            <span class="mr-2">üõí</span>
                            Purchase History
                        </button>
                        
                        <button onclick="handleLogout()" class="w-full bg-red-600 text-white py-3 rounded-lg font-semibold hover:bg-red-700 transition-colors flex items-center justify-center">
                            <span class="mr-2">üö™</span>
                            Log Out
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="fixed bottom-0 left-1/2 transform -translate-x-1/2 w-full max-w-md bg-white border-t border-gray-200">
            <div class="flex">
                <button onclick="showTab('home')" class="nav-btn flex-1 py-3 text-center text-xs font-medium text-gray-600 hover:text-blue-600 transition-colors active">
                    <div class="text-lg mb-1">üè†</div>
                    <div>Home</div>
                </button>
                <button onclick="showTab('mybooks')" class="nav-btn flex-1 py-3 text-center text-xs font-medium text-gray-600 hover:text-blue-600 transition-colors">
                    <div class="text-lg mb-1">üìö</div>
                    <div>My Books</div>
                </button>
                <button onclick="showTab('sell')" class="nav-btn flex-1 py-3 text-center text-xs font-medium text-white bg-green-600 hover:bg-green-700 transition-colors rounded-t-lg">
                    <div class="text-xl mb-1">‚ûï</div>
                    <div>Sell</div>
                </button>
                <button onclick="showTab('newbooks')" class="nav-btn flex-1 py-3 text-center text-xs font-medium text-gray-600 hover:text-blue-600 transition-colors">
                    <div class="text-lg mb-1">üÜï</div>
                    <div>New Books</div>
                </button>
                <button onclick="showTab('account')" class="nav-btn flex-1 py-3 text-center text-xs font-medium text-gray-600 hover:text-blue-600 transition-colors">
                    <div class="text-lg mb-1">üë§</div>
                    <div>Account</div>
                </button>
            </div>
        </div>
    </div>

    <script>
        function showTab(tabName) {
            // Hide all tab contents
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Update navigation buttons
            const navBtns = document.querySelectorAll('.nav-btn');
            navBtns.forEach(btn => btn.classList.remove('active'));
            
            // Find and activate the corresponding nav button
            const activeBtn = Array.from(navBtns).find(btn => 
                btn.onclick.toString().includes(tabName)
            );
            if (activeBtn && tabName !== 'sell') {
                activeBtn.classList.add('active');
            }
        }

        function handleSellBook(event) {
            event.preventDefault();
            
            // Get form data
            const formData = new FormData(event.target);
            const bookData = Object.fromEntries(formData);
            
            // Show success message
            alert('üéâ Your book has been listed successfully! It will be reviewed and published within 24 hours.');
            
            // Reset form
            event.target.reset();
            
            // Switch to My Books tab
            showTab('mybooks');
        }

        function handleUpdateProfile(event) {
            event.preventDefault();
            
            // Show success message
            alert('‚úÖ Profile updated successfully!');
        }

        function handleLogout() {
            if (confirm('Are you sure you want to log out?')) {
                alert('üëã You have been logged out successfully!');
                // In a real app, this would redirect to login page
            }
        }

        function showChat() {
            showTab('chat');
        }

        function showCart() {
            showTab('cart');
        }

        function chatWithSeller(bookId) {
            const sellerMap = {
                'gatsby': 'sarah',
                'python': 'mike',
                'calculus': 'emma',
                'marketing': 'alex',
                'physics': 'david'
            };
            
            showTab('chat');
            setTimeout(() => {
                openChat(sellerMap[bookId] || 'sarah');
            }, 100);
        }

        // Chat data
        const chatData = {
            sarah: {
                name: 'Sarah M.',
                avatar: 'üë§',
                status: 'Online',
                book: 'The Great Gatsby - $12.99',
                messages: [
                    { id: 1, text: 'Hi! I saw your listing for The Great Gatsby. Is it still available?', sender: 'me', time: '10:30 AM', status: 'read' },
                    { id: 2, text: 'Yes, it\'s still available! The book is in good condition with minimal wear.', sender: 'them', time: '10:32 AM' },
                    { id: 3, text: 'Great! Can you send me some photos of the book?', sender: 'me', time: '10:35 AM', status: 'read' },
                    { id: 4, text: 'Sure! Let me take some photos and send them to you.', sender: 'them', time: '10:37 AM' },
                    { id: 5, text: 'Is the book still available? Can we meet tomorrow?', sender: 'them', time: '2 min ago' }
                ]
            },
            mike: {
                name: 'Mike R.',
                avatar: 'üë§',
                status: 'Last seen 30 min ago',
                book: 'Python Programming - $45.00',
                messages: [
                    { id: 1, text: 'Hello! I\'m interested in your Python Programming book.', sender: 'me', time: '9:15 AM', status: 'read' },
                    { id: 2, text: 'Thanks for your interest! Yes, it\'s available.', sender: 'them', time: '9:20 AM' },
                    { id: 3, text: 'What\'s the condition of the book?', sender: 'me', time: '9:22 AM', status: 'read' },
                    { id: 4, text: 'It\'s like new! I barely used it during my course.', sender: 'them', time: '9:25 AM' },
                    { id: 5, text: 'Perfect! When can we meet?', sender: 'me', time: '9:30 AM', status: 'delivered' }
                ]
            },
            emma: {
                name: 'Emma L.',
                avatar: 'üë§',
                status: 'Online',
                book: 'Calculus: Early Transcendentals - $85.00',
                messages: [
                    { id: 1, text: 'Hi! I need this calculus book for my course.', sender: 'me', time: '8:45 AM', status: 'read' },
                    { id: 2, text: 'Great! It\'s a really good textbook. Are you a student?', sender: 'them', time: '8:50 AM' },
                    { id: 3, text: 'Yes, I\'m starting calculus next semester.', sender: 'me', time: '8:52 AM', status: 'read' },
                    { id: 4, text: 'Hi! Can you send more photos of the book?', sender: 'them', time: '3 hours ago' }
                ]
            }
        };

        let currentChatUser = null;

        function openChat(userId) {
            currentChatUser = userId;
            const user = chatData[userId];
            
            if (!user) return;

            // Update chat header
            document.getElementById('chatUserName').textContent = user.name;
            document.getElementById('chatUserStatus').textContent = user.status;
            document.getElementById('chatUserAvatar').textContent = user.avatar;

            // Show chat window, hide chat list
            document.getElementById('chatList').style.display = 'none';
            document.getElementById('chatWindow').classList.remove('hidden');
            document.getElementById('chatWindow').style.display = 'block';

            // Load messages
            loadChatMessages(user.messages);
        }

        function closeChatWindow() {
            document.getElementById('chatWindow').classList.add('hidden');
            document.getElementById('chatWindow').style.display = 'none';
            document.getElementById('chatList').style.display = 'block';
            currentChatUser = null;
        }

        function loadChatMessages(messages) {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML = '';

            messages.forEach(message => {
                const messageDiv = document.createElement('div');
                messageDiv.className = `flex ${message.sender === 'me' ? 'justify-end' : 'justify-start'} mb-3`;

                const messageContent = `
                    <div class="max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${
                        message.sender === 'me' 
                            ? 'bg-blue-600 text-white' 
                            : 'bg-white border border-gray-200'
                    }">
                        <p class="text-sm">${message.text}</p>
                        <div class="flex items-center justify-between mt-1">
                            <span class="text-xs opacity-70">${message.time}</span>
                            ${message.sender === 'me' ? `
                                <span class="text-xs ml-2">
                                    ${getMessageStatusIcon(message.status)}
                                </span>
                            ` : ''}
                        </div>
                    </div>
                `;

                messageDiv.innerHTML = messageContent;
                chatMessages.appendChild(messageDiv);
            });

            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function getMessageStatusIcon(status) {
            switch(status) {
                case 'sent': return '‚úì';
                case 'delivered': return '‚úì‚úì';
                case 'read': return '<span style="color: #4ade80;">‚úì‚úì</span>';
                default: return '‚è±Ô∏è';
            }
        }

        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const messageText = messageInput.value.trim();

            if (!messageText || !currentChatUser) return;

            const user = chatData[currentChatUser];
            const newMessage = {
                id: user.messages.length + 1,
                text: messageText,
                sender: 'me',
                time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                status: 'sent'
            };

            // Add message to chat data
            user.messages.push(newMessage);

            // Clear input
            messageInput.value = '';

            // Reload messages
            loadChatMessages(user.messages);

            // Simulate message status updates
            setTimeout(() => {
                newMessage.status = 'delivered';
                loadChatMessages(user.messages);
            }, 1000);

            setTimeout(() => {
                newMessage.status = 'read';
                loadChatMessages(user.messages);
            }, 3000);

            // Simulate auto-reply (optional)
            setTimeout(() => {
                const autoReply = {
                    id: user.messages.length + 1,
                    text: getAutoReply(messageText),
                    sender: 'them',
                    time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
                };
                user.messages.push(autoReply);
                loadChatMessages(user.messages);
            }, 5000);
        }

        function getAutoReply(messageText) {
            const replies = [
                "Thanks for your message! I'll get back to you soon.",
                "Sure, let me check and get back to you.",
                "That sounds good to me!",
                "I'm available to meet this week.",
                "Let me know what works best for you."
            ];
            return replies[Math.floor(Math.random() * replies.length)];
        }

        function handleMessageKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function showBookDetails(bookId) {
            const bookDetails = {
                gatsby: {
                    title: 'The Great Gatsby',
                    author: 'F. Scott Fitzgerald',
                    price: '$12.99',
                    condition: 'Good',
                    seller: 'Sarah M.',
                    location: 'New York, NY'
                },
                python: {
                    title: 'Python Programming',
                    author: 'John Smith',
                    price: '$45.00',
                    condition: 'Like New',
                    seller: 'Mike R.',
                    location: 'Boston, MA'
                }
            };

            const book = bookDetails[bookId] || bookDetails.gatsby;
            alert(`üìñ ${book.title} by ${book.author}\nüí∞ Price: ${book.price}\nüìç Location: ${book.location}\nüë§ Seller: ${book.seller}\nüìã Condition: ${book.condition}\n\nClick "Chat" to contact the seller!`);
        }

        function proceedToCheckout() {
            alert('üõí Proceeding to checkout... This would normally redirect to a secure payment page.');
        }

        function proceedWithPhonePe() {
            const totalInRupees = document.getElementById('totalInRupees').textContent;
            const upiId = 'rajput450@ybl';
            const merchantName = 'BookMarket';
            const transactionNote = 'BookMarket Purchase';
            
            // Remove commas from amount for UPI URL
            const amount = totalInRupees.replace(',', '');
            
            // Create UPI payment URL for PhonePe
            const upiUrl = `upi://pay?pa=${upiId}&pn=${encodeURIComponent(merchantName)}&am=${amount}&cu=INR&tn=${encodeURIComponent(transactionNote)}`;
            
            // Create PhonePe deep link (fallback to UPI if PhonePe app not installed)
            const phonepeUrl = `phonepe://pay?pa=${upiId}&pn=${encodeURIComponent(merchantName)}&am=${amount}&cu=INR&tn=${encodeURIComponent(transactionNote)}`;
            
            // Show confirmation before redirecting
            if (confirm(`üí≥ Confirm Payment\n\nAmount: ‚Çπ${totalInRupees}\nTo: ${merchantName}\nUPI ID: ${upiId}\n\nYou will be redirected to PhonePe app to complete the payment.`)) {
                
                // Try to open PhonePe app first, then fallback to generic UPI
                const tryPhonePe = () => {
                    window.location.href = phonepeUrl;
                    
                    // Fallback to generic UPI after a short delay
                    setTimeout(() => {
                        window.location.href = upiUrl;
                    }, 1000);
                };
                
                // For mobile devices, try direct app opening
                if (/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                    tryPhonePe();
                } else {
                    // For desktop, show QR code option or manual UPI ID
                    const desktopPayment = confirm(`üì± Mobile Payment Required\n\nTo complete the payment:\n1. Open PhonePe app on your mobile\n2. Scan QR code or enter UPI ID: ${upiId}\n3. Enter amount: ‚Çπ${totalInRupees}\n\nClick OK to copy UPI ID to clipboard, or Cancel to try mobile redirect.`);
                    
                    if (desktopPayment) {
                        // Copy UPI ID to clipboard
                        navigator.clipboard.writeText(upiId).then(() => {
                            alert(`‚úÖ UPI ID copied to clipboard!\n\n${upiId}\n\nAmount: ‚Çπ${totalInRupees}\n\nOpen PhonePe app and paste the UPI ID to make payment.`);
                        }).catch(() => {
                            alert(`üìã UPI ID: ${upiId}\nAmount: ‚Çπ${totalInRupees}\n\nPlease copy this UPI ID and use it in PhonePe app to make payment.`);
                        });
                    } else {
                        tryPhonePe();
                    }
                }
                
                // Show instructions
                setTimeout(() => {
                    alert(`üì± Payment Instructions:\n\n1. Complete payment in PhonePe app\n2. Return to this page after payment\n3. Your order will be confirmed\n\nAmount: ‚Çπ${totalInRupees}\nUPI ID: ${upiId}`);
                }, 2000);
            }
        }

        function updateCartQuantity(button, change) {
            const quantitySpan = button.parentElement.querySelector('.cart-quantity');
            const currentQty = parseInt(quantitySpan.textContent);
            const newQty = Math.max(1, currentQty + change);
            quantitySpan.textContent = newQty;
            
            // Update cart totals
            updateCartTotals();
        }

        function removeFromCart(button) {
            if (confirm('Remove this item from cart?')) {
                const cartItem = button.closest('.bg-white');
                cartItem.remove();
                updateCartTotals();
                alert('Item removed from cart!');
            }
        }

        function updateCartTotals() {
            const cartItems = document.querySelectorAll('#cartItems .bg-white');
            let totalItems = 0;
            let subtotal = 0;
            
            cartItems.forEach(item => {
                const quantity = parseInt(item.querySelector('.cart-quantity').textContent);
                const priceText = item.querySelector('.text-green-600').textContent;
                const price = parseFloat(priceText.replace('‚Çπ', '').replace(',', ''));
                
                totalItems += quantity;
                subtotal += price * quantity;
            });
            
            const shipping = 499;
            const grandTotal = subtotal + shipping;
            
            // Update display
            document.getElementById('totalItems').textContent = totalItems;
            document.getElementById('subtotal').textContent = '‚Çπ' + subtotal.toLocaleString();
            document.getElementById('grandTotal').textContent = '‚Çπ' + grandTotal.toLocaleString();
            document.getElementById('totalInRupees').textContent = grandTotal.toLocaleString();
            document.getElementById('cartBadge').textContent = totalItems;
        }

        function clearCart() {
            document.getElementById('cartItems').innerHTML = '<div class="text-center py-8 text-gray-500"><p class="text-lg mb-2">üõí</p><p>Your cart is empty</p></div>';
            document.getElementById('cartBadge').textContent = '0';
            document.getElementById('totalItems').textContent = '0';
            document.getElementById('subtotal').textContent = '‚Çπ0';
            document.getElementById('grandTotal').textContent = '‚Çπ499';
            document.getElementById('totalInRupees').textContent = '499';
        }

        // Quantity control functions
        function changeQuantity(button, change) {
            const quantitySpan = button.parentElement.querySelector('span');
            const currentQty = parseInt(quantitySpan.textContent);
            const newQty = Math.max(1, currentQty + change);
            quantitySpan.textContent = newQty;
        }

        function addToCartWithQuantity(button) {
            const bookCard = button.closest('.book-card');
            const bookTitle = bookCard.querySelector('h4').textContent;
            
            // Check if quantity controls exist (for books with quantity selectors)
            const quantitySpan = button.parentElement.querySelector('span');
            const quantity = quantitySpan ? parseInt(quantitySpan.textContent) : 1;
            
            // Show success popup
            showSuccessPopup(bookTitle, quantity);
            
            // Update cart badge
            const cartBadge = document.getElementById('cartBadge');
            const currentCount = parseInt(cartBadge.textContent);
            cartBadge.textContent = currentCount + quantity;
            
            // Reset quantity to 1 after adding to cart (only if quantity controls exist)
            if (quantitySpan) {
                quantitySpan.textContent = '1';
            }
        }

        function showSuccessPopup(bookTitle, quantity) {
            // Create popup element
            const popup = document.createElement('div');
            popup.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-2xl border-2 border-green-200 p-6 z-50 max-w-sm mx-4';
            popup.style.animation = 'popupSlideIn 0.3s ease-out';
            
            popup.innerHTML = `
                <div class="text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-3xl">‚úÖ</span>
                    </div>
                    <h3 class="text-lg font-bold text-gray-800 mb-2">Successfully Added!</h3>
                    <p class="text-gray-600 mb-1"><strong>"${bookTitle}"</strong></p>
                    <p class="text-sm text-gray-500 mb-4">Quantity: <span class="font-semibold text-green-600">${quantity}</span></p>
                    <div class="flex space-x-3">
                        <button onclick="closePopup()" class="flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors">
                            Continue Shopping
                        </button>
                        <button onclick="closePopup(); showCart();" class="flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors">
                            View Cart üõí
                        </button>
                    </div>
                </div>
            `;
            
            // Create overlay
            const overlay = document.createElement('div');
            overlay.className = 'fixed inset-0 bg-black bg-opacity-50 z-40';
            overlay.onclick = closePopup;
            
            // Add to page
            document.body.appendChild(overlay);
            document.body.appendChild(popup);
            
            // Store references for cleanup
            window.currentPopup = popup;
            window.currentOverlay = overlay;
            
            // Auto close after 3 seconds
            setTimeout(closePopup, 3000);
        }

        function closePopup() {
            if (window.currentPopup) {
                window.currentPopup.style.animation = 'popupSlideOut 0.3s ease-in';
                setTimeout(() => {
                    if (window.currentPopup) {
                        document.body.removeChild(window.currentPopup);
                        document.body.removeChild(window.currentOverlay);
                        window.currentPopup = null;
                        window.currentOverlay = null;
                    }
                }, 300);
            }
        }

        // Add to cart functionality for old buttons (fallback)
        document.addEventListener('click', function(e) {
            if (e.target.textContent === 'Add to Cart' && !e.target.onclick) {
                e.preventDefault();
                const bookTitle = e.target.closest('.book-card').querySelector('h4').textContent;
                alert(`üìö "${bookTitle}" has been added to your cart!`);
                
                // Update cart badge
                const cartBadge = document.getElementById('cartBadge');
                const currentCount = parseInt(cartBadge.textContent);
                cartBadge.textContent = currentCount + 1;
            }
        });

        // Cart quantity controls
        document.addEventListener('click', function(e) {
            if (e.target.textContent === '+') {
                const quantitySpan = e.target.previousElementSibling;
                const currentQty = parseInt(quantitySpan.textContent);
                quantitySpan.textContent = currentQty + 1;
            } else if (e.target.textContent === '-') {
                const quantitySpan = e.target.nextElementSibling;
                const currentQty = parseInt(quantitySpan.textContent);
                if (currentQty > 1) {
                    quantitySpan.textContent = currentQty - 1;
                }
            } else if (e.target.textContent === 'üóëÔ∏è') {
                if (confirm('Remove this item from cart?')) {
                    e.target.closest('.bg-white').remove();
                    alert('Item removed from cart!');
                }
            }
        });

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            showTab('home');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98b64ba891da85ae',t:'MTc1OTkzMzQwMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
<html>
<body>
  <h1>User List</h1>
  <ul id="users"></ul>

  <script>
    fetch("http://localhost/api.php")
      .then(res => res.json())
      .then(data => {
        let list = document.getElementById("users");
        data.forEach(u => {
          let li = document.createElement("li");
          li.textContent = ${u.id} - ${u.name} (${u.email});
          list.appendChild(li);
        });
  </script>
</body>
</html>
